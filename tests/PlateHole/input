#@  [2D-serial]
#@  dim    = 2 
#@  nprocs = 1
#@  check  = true
#@ 
#@  [3D-parallel]
#@  dim    = 3
#@  nprocs = 4
#@  check  = false
#@
#@  [3D-serial]
#@  dim    = 3
#@  nprocs = 1
#@  check  = false


alamo.program = mechanics

alamo.program.mechanics.model = affine.j2plastic
#alamo.program.mechanics.model = linear.cubic
#alamo.program.mechanics.model = linear.isotropic
#alamo.program.mechanics.model = affine.crystalplastic

plot_file		    = tests/PlateHole/output

# this is not a time integration, so do
# exactly one timestep and then quit
timestep		    = 0.01 #0.1
stop_time		    = 1.0 #0.1

amr.plot_int		    = 1
#amr.plot_dt         = 0.1

amr.blocking_factor	    = 8
amr.regrid_int		    = -1
amr.grid_eff		    = 1.0
amr.node.all                = 1
amr.cell.all                = 1

# grid
amr.max_level		    = 6 #8
amr.n_cell		    = 32 32 32

# geometry
geometry.prob_lo	    = -16 -16 -16
geometry.prob_hi	    = 16 16 16
geometry.is_periodic	    = 0 0 0

# ellipse configuration
psi.ic.type        = ellipse
psi.ic.ellipse.number_of_inclusions  = 4
psi.ic.ellipse.a   = 1 1 1 1 1 1 1 1   # ellipse radius
psi.ic.ellipse.x0  = -6 1 -2 -1 2 1 6 -1 # location of ellipse center
psi.ic.ellipse.eps = 0.2
psi.ic.ellipse.invert = 1

# elastic moduli
nmodels = 1
model1.E = 2.10
model1.nu = 0.3
#model1.planestress = 1
model1.yield = 0.002
model1.theta = 1.0
model1.hardening = 0.5

# model1.C11 = 1.6840
# model1.C12 = 1.2140
# model1.C44 = 0.7540
# model1.hardening.on = 1
# model1.hardening.g0 = 0.00016 #0.016
# model1.hardening.gs = 0.000704 #0.0704
# model1.hardening.h0 = 0.00132 #0.132
# model1.hardening.hs = 0.00008 #0.008
# model1.hardening.qh = 1.4
# model1.exp = 10.0
# model1.gam0dot = 0.001


solver.verbose = 4
solver.nriters = 1
solver.fixed_iter = 500
solver.bottom_solver = smoother
solver.tol_abs = 1E-16 # This is very important for near-singular problems!!!
#solver.tol_rel = 1E-16
#solver.bottom_tol_rel = 1E-16
#solver.bottom_tol_abs = 1E-16

print_residual = 1
print_model = 1

bc.type = tension_test
bc.tension_test.type = uniaxial_stress
#bc.tension_test.disp=0.002
#bc.tension_test.disp = (0,0.25,0.75,1.0:0,0.002,-0.002,0)
bc.tension_test.disp = (0,1.0:0,0.8)

elasticop.small=1E-16

#elastic_ref_threshold = 1E-4
